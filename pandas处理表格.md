# pandas处理表格入门




目录
[TOC]



### 1.首先安装pandas包，处理excel需要xlrd包。
> 需要注意的是，国外镜像开了vpn依然无法正常install,因此我试过豆瓣的也不行，最后使用了清华的镜像。清华牛逼！如果你没有任何python基础甚至连python都没装，不知道我在说什么，这个页面建议你去浏览一下，我不会害你的，有时提高效率是需要付出一点代价的。https://www.runoob.com/python/python-tutorial.html

### 2.读取excel文件
> 如果你已经装好了所有内容，那么我们开始吧，直接建个excel表作为示例，可以明明为test.xlsx.表的结构如下

| 序号 | 姓名 | 学号 | 性别 | 年龄 |
| ---- | ---- | ---- | ---- | ---- |
| 1 | jerry | 123 | 男 | 12 |
| 2    | alex | 235  | 男   | 34   |
| 3    | ben    | 23   | 男   | 53   |
| 4    | alice  | 525  | 女   | 21   |
> 完成以后，我们可以尝试操作这个表格。代码如下
```python
import pandas as pd
a = pd.read_excel('test.xlsx', sheet_name='Sheet1')
print(a)
```
> 首先将pandas包导入，因为pandas这个名字太长，我将其以pd之名引用。
> 声明一个变量a,调用pandas对象的read_excel方法，这个方法传入两个参数，一个很显然是你的文件路径，如果你的excel就在当前路径，也就是在你脸上，那么不需要任何的文件路径描述，直接用文件名就行了，就如我上面的代码这样。第二个参数是你需要读取的sheet名，如果不传入这个参数的话，默认读取所有sheet.
> 最后输出a，你知道终端会打印出什么内容吗？就是把整个表格打印出来给你看。
>
> ![](C:\Users\47174\Desktop\md\img1.png)
>
> 这显然不是我们要的功能。

### 3.获取指定列的信息
> 据我所知，有的电商大佬会有那么一张表格，这张表格里有成千上万的产品数据，每一行数据都对应一个产品，每个产品都有一个链接。如果想要一次性获取所有产品链接该咋整。在我们这个例子里，你可以把姓名当作是电商产品的链接，那么简化问题就是，我如何一次性获得整个表格的姓名呢？看我下面的操作
```python
import pandas as pd
a = pd.read_excel('test.xlsx', sheet_name='Sheet1',header=0,usecols=['姓名'])
print(a)
```

![](C:\Users\47174\Desktop\md\img2.png)

> 这一次我们多传了两个参数给他，header也就是表头，是你的起始行，0代表将第一行作为表头，而usecols参数穿了个列表，你可以把它戏称为数组，代表了一个一个的列名，这里我偷懒只传了一列，因此最后我只获得了这一列的数据，不过对于某种场景也已经够用了。你思考一下，如果这一列是电商大佬的宝贝链接，是不是可以干一番大事。（有一个东西叫做爬虫 ^_^||| ）

### 4.将指定列信息转为列表输出
> 有人会说，我要的是把这个列整体转为一个数组，然后才能方便我去遍历它，你这个打印出来有什么卵用？
>
> 因此接下来我将通过如下操作将他转为数组，方便各位爷遍历。
>
```
import pandas as pd
a = pd.read_excel('test.xlsx', sheet_name='Sheet1',index_col=None,usecols=['姓名'])
b = a.values.tolist()
c = [i[0] for i in b ]
print(c)
```

![](C:\Users\47174\Desktop\md\img3.png)

> 可能有些同学觉得这一步跨度有点大，不太好消化，可以听我分析一下。首先我又传了一个参数index_col=None,大家有没有发现前面的打印结果都带有一个序号列，有些场景我就是不要这个序号列，怎么办，这个参数就是这样用的。紧接着调用了values.tolist()将他转化为一个列表。但是烦人的是，他这一个列表里面仍然是一个一个的列表，有点俄罗斯套娃的意思，因此我在遍历最外面这个列表时，将每一个子列表的第一个条目（实际上他就只有一个条目）取出来统统存到变量列表c中，最后输出一个c。有了这个c,配合requests不久可以遍历爬取宝贝链接读取价格等其他宝贝信息了嘛，嘿嘿，最后还可以把信息再存回excel表格里，如果你的表格有1000行，一秒钟就搞定了，岂不美哉？
> 想提高效率，就得多动脑子。
> 少许的牺牲是必要的——史蒂夫·乔布斯
> 今天就讲这么多，太多了不好吸收。下次见。